<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calendyear</title>
<style>
  body { font-family: Arial, sans-serif; background: #111; color: white; margin:0; padding:0; }
  #login, #main { padding: 20px; max-width: 800px; margin: auto; }
  #login { text-align: center; margin-top: 100px; }
  input, button { font-size: 1.2em; padding: 10px; margin: 10px 0; }
  #error { color: #f55; }

  #title { font-size: 4em; text-align: center; margin: 20px 0; }

  #menu { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px; }
  .month-button {
    flex: 1 1 120px;
    height: 120px;
    border-radius: 12px;
    cursor: pointer;
    color: white;
    font-weight: bold;
    font-size: 1.1em;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 8px #222;
    transition: background-color 0.3s ease;
    position: relative;
    overflow: hidden;
  }
  .month-button img {
    max-height: 50px;
    margin-bottom: 6px;
    border-radius: 6px;
    box-shadow: 0 0 4px black;
  }
  .locked {
    filter: grayscale(100%) brightness(0.4);
    cursor: not-allowed;
  }
  .lock-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2em;
  }

  #enigme {
    background: #222;
    border-radius: 10px;
    padding: 20px;
    max-width: 700px;
    margin: auto;
  }
  #enigme h2 { margin-top: 0; text-align:center; }
  #enigme input[type="text"] {
    padding: 8px;
    font-size: 1em;
    width: 60%;
  }
  #enigme button {
    font-size: 1em;
    padding: 8px 15px;
    margin-left: 10px;
  }
  #enigme p.error { color: #f55; }
  #enigme p.success { color: #5f5; font-weight: bold; }

  #back-button {
    margin-top: 20px;
    cursor: pointer;
    color: #ddd;
    text-decoration: underline;
    text-align:center;
  }

  .riddle-box {
    background: #333;
    padding: 15px;
    border-radius: 8px;
    max-width: 400px;
    margin: auto;
    text-align: center;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
</head>
<body>

<div id="login">
  <h1>Calendyear</h1>
  <p>R√©sous cette √©quation pour entrer :</p>
  <p id="equation" style="font-size: 1.5em; font-weight: bold; text-align: center; margin-bottom: 40px;">
  \[
    \left| \int_{a_s}^{a_{s+1}} (T_h \circ m)(x) \, dx \right|
  \]
  </p>

  <div style="max-width:700px; margin:auto; color:#ddd; font-size:1em; line-height:1.5em; text-align: left;">
  \[
    m(x) = \text{nombre de nombres premiers pairs}
  \]

  \[
    a_s = \cos(I_n) \quad \text{avec} \quad I_n \in \mathbb{R}
  \]

  \[
    S = \mathbb{R}
  \]

  \[
    T_h = \sum_{n=0}^{+\infty} \left(\frac{1}{2}\right)^n y + \lim_{t \to 0} \frac{\sin(t)}{t}
  \]
  </div>

  <input type="text" id="passwordInput" placeholder="Votre r√©ponse" />
  <br />
  <button onclick="checkPassword()">Entrer</button>
  <p id="error"></p>
</div>


<div id="main" style="display:none;">
  <div id="title">Calendyear</div>
  <div id="progress" style="text-align:center; font-size:1.2em; margin-bottom:20px;"></div>
  <div id="menu"></div>
  <div id="enigme" style="display:none;"></div>
</div>

<script>
const devMode = false; // ‚Üê mettre false pour activer le blocage des mois futurs

const months = [
  { name: "Octobre", theme: "Halloween", color: "#FF7518", img: "https://www.hostelworld.com/blog/wp-content/uploads/2014/10/5pumpkins.jpg", answer: "vert", riddle: "La r√©ponse est dans le coffret" },
  { name: "Novembre", theme: "D√©co fait main", color: "#8B4513", img: "https://bpifrance-creation.fr/sites/default/files/2020-02/loisisr_creatifs_670x350.jpg", answer: "4", riddle: "P62 L13 M2 : combien ?" },
  { name: "D√©cembre", theme: "No√´l", color: "#228B22", img: "https://www.filolit.fr/modules/prestablog/views/img/grid-for-1-7/up-img/10.jpg", answer: "Flamecraft Duals ", riddle: "Quel est ton cadeau de no√´l ?" },
  { name: "Janvier", theme: "Galette des rois", color: "#DAA520", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSEklcBMwFm2Kvu5u_aQMXq_fnBul9mbcXmIw&s", answer: "289", riddle: "Alors ?" },
  { name: "F√©vrier", theme: "St Valentin", color: "#FF1493", img: "https://www.filsantejeunes.com/wp-content/uploads/2021/08/amour-vacances-dossier2-e1633359863492.jpg", answer: "sometimes", riddle: "Quel est le bon mot ?" },
  { name: "Mars", theme: "F√™te des pandas roux", color: "#CD5C5C", img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRPceZA7lbo6CYfqOJ5GJJeea-6HfdaUru79w&s", answer: "43", riddle: "Combien y a-t-il de pandas roux ?" },
  { name: "Avril", theme: "Anniversaire & P√¢ques", color: "#FFD700", img: "https://www.cabinetjourdan.com/wdpr/wp-content/uploads/2022/04/Fete-de-Paques.png", answer: "R√©", riddle: "O√π a √©t√© prise la photo de moi ?" },
  { name: "Mai", theme: "Electronique", color: "#00CED1", img: "https://upload.wikimedia.org/wikipedia/commons/d/d9/Arduino_ftdi_chip-1.jpg", answer: "7", riddle: "Combien de fois clignote la LED en vert ?" },
  { name: "Juin", theme: "Voyage", color: "#1E90FF", img: "https://www.grand-est.ars.sante.fr/system/files/2023-06/Voyage%20pr%C3%A9paration.jpg", answer: "3901", riddle: "Quel est le bon num√©ro de l'adresse de mon h√¥tel?" },
  { name: "Juillet", theme: "Anniversaire", color: "#FF4500", img: "https://www.shutterstock.com/image-illustration/joyeux-anniversaire-happy-birthday-french-260nw-1398992075.jpg", answer: "Baiocchi", riddle: "Quel est le produit ?" },
  { name: "Ao√ªt", theme: "√ât√©", color: "#FFA500", img: "https://dictionnaire.lerobert.com/statics/medias/images/blog/2524/top-10-mots-ete-dico-en-ligne-le-robert.jpg", answer: "", riddle: "" }, // truc avec jeu de plage
  { name: "Septembre", theme: "Nous", color: "#6A5ACD", img: "https://m.media-amazon.com/images/I/31gOHJz5tTL._UF1000,1000_QL80_.jpg", answer: "Je t'aime mon petit Soleil <3", riddle: "Quel est la phrase code dans la bo√Æte ? Steven en est le gardien." }
];

const correctAnswer = "204";

// Mois d√©bloqu√© √† partir d'octobre 2025
const startYear = 2025;
const startMonthIndex = 0; // octobre
const currentDate = new Date();
const currentYear = currentDate.getFullYear();
const currentMonth = currentDate.getMonth(); // 0 = janvier

window.onload = function(){
  if(localStorage.getItem("siteUnlocked") === "true"){
    document.getElementById("login").style.display = "none";
    document.getElementById("main").style.display = "block";
    loadMenu();
  }
};

function checkPassword(){
  let val = document.getElementById("passwordInput").value.trim().toLowerCase();
  if(val === correctAnswer){
    localStorage.setItem("siteUnlocked", "true");
    document.getElementById("login").style.display = "none";
    document.getElementById("main").style.display = "block";
    loadMenu();
  } else {
    document.getElementById("error").textContent = "Mauvaise r√©ponse, r√©essayez !";
  }
}

function loadMenu(){
  const menu = document.getElementById("menu");
  menu.innerHTML = "";

  let solvedCount = months.filter((_,i) => localStorage.getItem("enigmeSolved_" + i) === "true").length;
  document.getElementById("progress").innerHTML = `
    <div style="margin-bottom:10px;">Progression : ${solvedCount} / 12</div>
    <div style="display:flex; justify-content:center; gap:5px; flex-wrap:wrap;">
      ${months.map((_,i) => {
        const solved = localStorage.getItem("enigmeSolved_" + i) === "true";
        return `<div style="width:20px; height:20px; background:${solved ? '#228B22' : '#b22222'}; border-radius:4px;"></div>`;
      }).join('')}
    </div>
  `;

  const now = new Date();
  const currentMonth = now.getMonth(); // 0 = Janvier, 9 = Octobre
  const currentYear = now.getFullYear();

  const startYear = 2025; // ton ann√©e de d√©part (octobre 2025)

  months.forEach((month, i) => {
    const key = "enigmeSolved_" + i;
    const solved = localStorage.getItem(key) === "true";

    // Calcul de l'ann√©e du mois dans le cycle
    let monthYear;
    if (i >= 0 && i <= 2) { // Oct, Nov, Dec ‚Üí ann√©e de d√©part
      monthYear = startYear;
    } else {
      monthYear = startYear + 1;
    }

    // Mois r√©el correspondant
    const realMonthIndex = (9 + i) % 12; // Oct = 9, Nov = 10, etc.

    // V√©rifie si le mois est d√©bloqu√©
    // V√©rifie si le mois est d√©bloqu√©
    let locked = false;
    if (!devMode) {
      if (monthYear > currentYear || (monthYear === currentYear && realMonthIndex > currentMonth)) {
        locked = true;
      }
    } else {
      locked = false; // DEV MODE : tout d√©bloqu√©
    }


    const btn = document.createElement("div");
    btn.className = "month-button";
    btn.style.backgroundColor = month.color;
    btn.title = month.theme;

    if (locked) {
      btn.innerHTML = `<div style="position:absolute; inset:0; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; font-size:2em;">üîí</div><div>${month.name}</div>`;
      btn.style.filter = "grayscale(100%)";
      btn.style.cursor = "not-allowed";
    } else {
      btn.innerHTML = `<img src="${month.img}" alt="${month.theme}" /><div>${month.name}</div>`;
      if(solved){
        btn.style.boxShadow = "0 0 12px 3px #228B22";
      }
      btn.onclick = () => showRiddle(i);
    }

    menu.appendChild(btn);
  });
}

function showRiddle(index){
  const enigmeDiv = document.getElementById("enigme");
  const menuDiv = document.getElementById("menu");

  const month = months[index];

  enigmeDiv.style.display = "block";
  menuDiv.style.display = "none";

  enigmeDiv.innerHTML = `
    <h2>${month.name}</h2>
    <div class="riddle-box">
      <p>${month.riddle}</p>
      <input type="text" id="answerInput" placeholder="Votre r√©ponse" />
      <button onclick="checkRiddle(${index})">Valider</button>
      <p id="riddleFeedback"></p>
    </div>
    <div id="back-button" onclick="backToMenu()">‚Üê Retour au menu</div>
  `;
}

function checkRiddle(index){
  const userAnswer = document.getElementById("answerInput").value.trim().toLowerCase();
  const correct = months[index].answer.toLowerCase();
  const feedback = document.getElementById("riddleFeedback");

  if(userAnswer === correct){
    feedback.textContent = "Bravo, √©nigme r√©solue !";
    feedback.className = "success";
    localStorage.setItem("enigmeSolved_" + index, "true");
    setTimeout(() => {
      backToMenu();
      loadMenu();
    }, 1500);
  } else {
    feedback.textContent = "Ce n‚Äôest pas la bonne r√©ponse, r√©essaye.";
    feedback.className = "error";
  }
}

function backToMenu(){
  document.getElementById("enigme").style.display = "none";
  document.getElementById("menu").style.display = "flex";
}
</script>

</body>
</html>
